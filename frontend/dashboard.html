<!DOCTYPE html>
<html>
<head>
    <title>Dashboard - Academia Cante</title>
</head>
<body>
    <h1>Panel del opositor</h1>

    <div id="info-usuario">
        <p>Cargando información del perfil...</p>
    </div>

    <hr>

    <h2>Temario: Inspección de Hacienda – Ejercicio 4</h2>
    <ul id="lista-temas">
        <li>Cargando temas...</li>
    </ul>

    <hr>

    <button onclick="logout()">Cerrar sesión</button>

    <script>
        async function cargarPerfil() {
            const token = localStorage.getItem('token');
            if (!token) {
                alert("No has iniciado sesión");
                window.location.href = "/login";
                return;
            }

            const res = await fetch('/perfil', {
                headers: { 'Authorization': 'Bearer ' + token }
            });

            if (res.ok) {
                const data = await res.json();
                document.getElementById('info-usuario').innerHTML = `
                    <p><strong>Nombre:</strong> ${data.nombre}</p>
                    <p><strong>Email:</strong> ${data.email}</p>
                    <p><strong>Oposición:</strong> ${data.oposicion}</p>
                `;

                // Si es Inspección de Hacienda, cargar los temas
                if (data.oposicion === "Inspección de Hacienda") {
                    cargarTemas();
                } else {
                    document.getElementById('lista-temas').innerHTML = "<li>No hay temas disponibles para tu oposición.</li>";
                }

            } else {
                alert("Token inválido o expirado. Inicia sesión de nuevo.");
                window.location.href = "/login";
            }
        }

        async function cargarTemas() {
            const res = await fetch('/temas/Inspección de Hacienda/4');
            if (res.ok) {
                const temas = await res.json();
                const ul = document.getElementById('lista-temas');
                ul.innerHTML = ""; // limpiar placeholder
                temas
